#generated by `lor framework`

pid tmp/nginx.pid;
worker_processes 4;
events {
    worker_connections 4096;
}

http {
    include ./mime.types;

    client_max_body_size 10m;    #允许客户端请求的最大单文件字节数
    client_body_buffer_size 10m;  #缓冲区代理缓冲用户端请求的最大字节数

    sendfile on;
    keepalive_timeout  65;
    charset utf8;

    lua_package_path "./app/?.lua;./app/library/?.lua;./app/?/init.lua;./?.lua;/usr/local/lor/?.lua;/usr/local/lor/?/init.lua;;";
    lua_package_cpath "./app/library/?.so;/usr/local/lor/?.so;;";
    lua_code_cache on; # set on @production
    #LUA_SHARED_DICT


    server {
        resolver local=on ipv6=off;
        resolver_timeout 5s;

        listen 80;
        #server_name openresty-china.com;
        set $template_root '';

        # 用户上传的静态文件目录
        set $static_files_path "/data/openresty-china/static";

        # 头像和文章、评论图片
        location /static/avatar {
            alias $static_files_path;
        }
        location /static/files {
            alias $static_files_path;
        }

        # 项目本身的静态文件
        location /static/css {
            alias ./app/static/css;
        }
        location /static/community {
            alias ./app/static/community;
        }
        location /static/fonts {
            alias ./app/static/fonts;
        }
        location /static/js {
            alias ./app/static/js;
        }
        location /static/libs {
            alias ./app/static/libs;
        }


        # Access log with buffer, or disable it completetely if unneeded
        access_log logs/prod-access.log combined buffer=16k;
        # Error log
        error_log logs/prod-error.log;

        # lor runtime
        location / {
            content_by_lua_file ./app/main.lua;
        }
    }
}


